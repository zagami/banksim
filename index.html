<!DOCTYPE html>
<html>
<head>
 <!--JS Libraries -->
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-2.1.4.js"></script>

  <!-- Knockout.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.3.0/knockout-min.js"></script>
  
  <!-- highcharts -->
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>

  <!-- stylesheet -->
  <link rel="stylesheet" type="text/css" href="css/style.css">
 
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script src="src/microeconomy.js"></script>
  <script src="src/banksim.js"></script>
  
  <title>BankSim</title>
</head>

<body>

<h1>BankSim</h1>
<div id="left">
<div id="controls">
  <a href=":blank" data-bind="click: lang_de_clicked">DE</a>
  <a href=":blank" data-bind="click: lang_en_clicked">EN</a>
  <h2>Steuerung</h2>
  <table>
    <tr>
      <td colspan=2><input type="button" value="Simulate" data-bind="click: simulate_clicked"/></td>
    </tr>
    <tr>
      <td class="label">Jahre pro Schritt: </td>
      <td><input data-bind="value: yearsPerStep" id="slider1" type="range" min="1" max="100" step="5" /> <span data-bind="text: yearsPerStep"></span>
      </td>
    </tr>
    <tr>
      <td class="label">Autorun</td>
      <!--<td><button  data-bind='text: autorun, click: autorun_clicked'></button></td>-->
      <td><input type="checkbox" id="autorun_chk" data-bind="checked: autorun, click: autorun_clicked"> </td>
    </tr>
    <tr>
      <td class="label">Visualisierung</td>

      <td>
        Tabelle:<input type="checkbox" data-bind="checked: tableViz_checked, click: viz_clicked" /><br>

        Diagramm:<input type="checkbox" data-bind="checked: diagramViz_checked, click: viz_clicked"/>
      </td>
    </tr>
    <tr>
      <td><input type="button" value="Reset" data-bind="click: reset_clicked"/></td>
      <td><input type="text" data-bind="value: step"/></td>
    </tr>
  </table>
</div>

<div id="params">
  <h2>Parameter</h2>
  <table>
    <tr>
      <td class="label">Max Transaktionen pro Jahr</td>
      <!--<td><input type="number" data-bind="value:max_trx" name="max_trx" min="1" max="1000"></td>-->
      <td><input type="range" id="foo"  min="1" max="1000" step="5" data-bind="value: max_trx"/><span data-bind="text: max_trx"></td>
    </tr>
    <tr>
      <td class="label">Leitzins: ZB Kredite</td>
      <td><input data-bind="value: prime_rate" id="slider_lz" type="range" min="0" max="15" step="0.1" /> <span data-bind="text: prime_rate"></span>%</td>
    </tr>

    <tr>
      <td class="label">Leitzins: ZB Konten</td>
      <td><input data-bind="value: prime_rate_giro" id="slider_lz" type="range" min="-15" max="15" step="0.1" /> <span data-bind="text: prime_rate_giro"></span>%</td>
    </tr>
    <tr>
      <td class="label">Eigenkapitalvorschrift</td>
      <td><input data-bind="value: cap_req" id="slider_lz" type="range" min="0" max="50" step="1" /> <span data-bind="text: cap_req"></span>%</td>
    </tr>
    <tr>
      <td class="label">Mindestreserve</td>
      <td><input data-bind="value: minimal_reserves" id="slider_lz" type="range" min="0" max="50" step="1" /> <span data-bind="text: minimal_reserves"></span>%</td>
    </tr>
    <tr>
      <td class="label">Kreditzinsen</td>
      <td><input data-bind="value: credit_interest" id="slider_lz" type="range" min="0" max="10" step="0.1" /> <span data-bind="text: credit_interest"></span>%</td>
    </tr>
    <tr>
      <td class="label">Guthabenszinsen</td>
      <td><input data-bind="value: deposit_interest" id="slider_lz" type="range" min="0" max="10" step="0.1" /> <span data-bind="text: deposit_interest"></span>%</td>
    </tr>

  </table>
</div>
</div>

<div id="viz">
  <div id="graphs">
    <div id="cb_graph" class="block"style="margin: 0 auto"></div> 
    <div id="banks_total_graph" class="block"style="margin: 0 auto"></div> 
    <div id="stats_graph1" class="block" style="margin: 0 auto"></div>
    <div id="stats_graph2" class="block" style="margin: 0 auto"></div>
    <div id="banks_graph" class="block" style="margin: 0 auto"></div>
    <div id="banks_graph2" class="block" style="margin: 0 auto"></div>
  </div>

  <div id="tables">
    <div id="cb_table" class="block" style="margin: 0 auto"></div>
    <div id="ms_table" class="block" style="margin: 0 auto"></div>
    <div id="banks_table" class="block" style="margin: 0 auto"></div>
  </div>
</div>

<script type="text/javascript" src="lib/shortcut.js"></script>

<script>
<!--http://stackoverflow.com/questions/5061353/how-to-create-a-keyboard-shortcut-for-an-input-button-->
    shortcut.add("n", function() {
        // Do something
        params.simulate_clicked();
    }); 
    shortcut.add("r", function() {
        // Do something
        params.reset_clicked();
    });  
    shortcut.add("a", function() {
        // Do something
        params.autorun_clicked();
    });  
</script>

<xmp theme="superhero" style="display:none;">
# Money Simulator

## Shortcuts

* You can press **n** to simulate one step
* You can press **r** to reset the simulation
* You can press **a** to toggle Autorun mode

## Assuptions of the simulation
- There is 1 central bank
- There is a fixed number of banks
- The simulation runs year by year. For every year, the following steps will be performed:
  * a random number of transactions is performed:
    - the upper limit of the number of transactions can be set as a parameter
    - the amount of each transaction is random as well, its upper limit is the amount of bank deposits
    - if a bank has not enough reserves to make the transaction it can take a loan from the central bank first
    - interbank credits are not implemented yet
    - for every transaction 2 random banks are chosen  

- A bank can go bankrupt if...
    * the capital requirements cannot be met
    * the minimal reserves requirements cannot be fulfilled
    * A bank that is bankrupt is out of the game

- The debts of the bank to the central bank or to customers is lost if it goes bankrupt, the money supply shrinks accordingly

- minimal reserves requirements are in relation to the customer deposits, not central bank debt or interbank debt
- capital requirements are in relation to all liabilities (leverage ratio), not as in BASEL II only to a subset of risky assets

- custumers pay back their loans every year:
  * the amount is random, the upper limit is of course the bank deposits

- custumers are taking loans every year:
  * the amount is random with an upper limit based on the credit potential of the bank. This potential is computed according to the reserves and the capital of the bank. 

</xmp>

<script src="http://strapdownjs.com/v/0.2/strapdown.js"></script>
<!-- <script type="text/javascript" src="lib/strapdown.js"></script> -->
</body>
</html>
